{"ast":null,"code":"import{useEffect,useState}from\"react\";import axiosClient from\"../api/axiosClient\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const navigate=useNavigate();const[posts,setPosts]=useState([]);const fetchPost=async()=>{try{const res=await axiosClient.get(\"/post/posts\");setPosts(res.data);}catch{alert(\"Failed to load posts\");}};useEffect(()=>{const token=localStorage.getItem(\"token\");if(!token){navigate(\"/login\");return;}fetchPost();},[navigate]);const handleLogout=()=>{localStorage.removeItem(\"token\");navigate(\"/login\");};const handleDelete=async postId=>{if(!window.confirm(\"Are you sure you want to delete this post?\"))return;try{await axiosClient.delete(`/post/delete/${postId}`);alert(\"Post Deleted\");fetchPost();}catch(err){alert(\"Failed to delete post\");}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"All Posts\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"}),posts.length===0&&/*#__PURE__*/_jsx(\"p\",{children:\"No posts found.\"}),/*#__PURE__*/_jsx(\"ul\",{children:posts.map(post=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:post.postTitle}),/*#__PURE__*/_jsx(\"p\",{children:post.postContent}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Posted on: \",new Date(post.postCreated).toLocaleString()]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(post.postId),children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(`/post/post/${post.postId}`),children:\"Edit\"})]},post.postId))})]});};export default Home;","map":{"version":3,"names":["useEffect","useState","axiosClient","useNavigate","jsx","_jsx","jsxs","_jsxs","Home","navigate","posts","setPosts","fetchPost","res","get","data","alert","token","localStorage","getItem","handleLogout","removeItem","handleDelete","postId","window","confirm","delete","err","children","onClick","length","map","post","postTitle","postContent","Date","postCreated","toLocaleString"],"sources":["C:/Users/Junzhang Ren/Desktop/post-management-frontend/src/pages/Home.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport axiosClient from \"../api/axiosClient\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst Home = () =>{\r\n  const navigate = useNavigate();\r\n  const [posts, setPosts] = useState([]);\r\n\r\n  const fetchPost = async () => {\r\n    try {\r\n      const res = await axiosClient.get(\"/post/posts\")\r\n      setPosts(res.data);\r\n    } catch {\r\n      alert(\"Failed to load posts\")\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n\r\n    if (!token) {\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n\r\n    fetchPost();\r\n  },[navigate]);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    navigate(\"/login\");\r\n  }\r\n\r\n  const handleDelete = async (postId) => {\r\n    if (!window.confirm(\"Are you sure you want to delete this post?\")) return;\r\n\r\n    try {\r\n      await axiosClient.delete(`/post/delete/${postId}`);\r\n      alert(\"Post Deleted\");\r\n      fetchPost();\r\n    } catch (err) {\r\n      alert(\"Failed to delete post\");\r\n    }\r\n  };\r\n\r\n  return(\r\n    <div> \r\n      <h2>All Posts</h2>\r\n      <button onClick={handleLogout}>Logout</button>\r\n      {posts.length === 0 && <p>No posts found.</p>}\r\n      <ul>\r\n        {posts.map(post => (\r\n          <li key={post.postId}>\r\n            <h3>{post.postTitle}</h3>\r\n            <p>{post.postContent}</p>\r\n            <small>Posted on: {new Date(post.postCreated).toLocaleString()}</small>\r\n            <button onClick={() => handleDelete(post.postId)}>Delete</button>\r\n            <button onClick={() => navigate(`/post/post/${post.postId}`)}>Edit</button>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,WAAW,KAAM,oBAAoB,CAC5C,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,KAAM,CAAAC,IAAI,CAAGA,CAAA,GAAK,CAChB,KAAM,CAAAC,QAAQ,CAAGN,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACO,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAEtC,KAAM,CAAAW,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAX,WAAW,CAACY,GAAG,CAAC,aAAa,CAAC,CAChDH,QAAQ,CAACE,GAAG,CAACE,IAAI,CAAC,CACpB,CAAE,KAAM,CACNC,KAAK,CAAC,sBAAsB,CAAC,CAC/B,CACF,CAAC,CAEDhB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACVR,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CAEAG,SAAS,CAAC,CAAC,CACb,CAAC,CAAC,CAACH,QAAQ,CAAC,CAAC,CAEb,KAAM,CAAAW,YAAY,CAAGA,CAAA,GAAM,CACzBF,YAAY,CAACG,UAAU,CAAC,OAAO,CAAC,CAChCZ,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,CAED,KAAM,CAAAa,YAAY,CAAG,KAAO,CAAAC,MAAM,EAAK,CACrC,GAAI,CAACC,MAAM,CAACC,OAAO,CAAC,4CAA4C,CAAC,CAAE,OAEnE,GAAI,CACF,KAAM,CAAAvB,WAAW,CAACwB,MAAM,CAAC,gBAAgBH,MAAM,EAAE,CAAC,CAClDP,KAAK,CAAC,cAAc,CAAC,CACrBJ,SAAS,CAAC,CAAC,CACb,CAAE,MAAOe,GAAG,CAAE,CACZX,KAAK,CAAC,uBAAuB,CAAC,CAChC,CACF,CAAC,CAED,mBACET,KAAA,QAAAqB,QAAA,eACEvB,IAAA,OAAAuB,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBvB,IAAA,WAAQwB,OAAO,CAAET,YAAa,CAAAQ,QAAA,CAAC,QAAM,CAAQ,CAAC,CAC7ClB,KAAK,CAACoB,MAAM,GAAK,CAAC,eAAIzB,IAAA,MAAAuB,QAAA,CAAG,iBAAe,CAAG,CAAC,cAC7CvB,IAAA,OAAAuB,QAAA,CACGlB,KAAK,CAACqB,GAAG,CAACC,IAAI,eACbzB,KAAA,OAAAqB,QAAA,eACEvB,IAAA,OAAAuB,QAAA,CAAKI,IAAI,CAACC,SAAS,CAAK,CAAC,cACzB5B,IAAA,MAAAuB,QAAA,CAAII,IAAI,CAACE,WAAW,CAAI,CAAC,cACzB3B,KAAA,UAAAqB,QAAA,EAAO,aAAW,CAAC,GAAI,CAAAO,IAAI,CAACH,IAAI,CAACI,WAAW,CAAC,CAACC,cAAc,CAAC,CAAC,EAAQ,CAAC,cACvEhC,IAAA,WAAQwB,OAAO,CAAEA,CAAA,GAAMP,YAAY,CAACU,IAAI,CAACT,MAAM,CAAE,CAAAK,QAAA,CAAC,QAAM,CAAQ,CAAC,cACjEvB,IAAA,WAAQwB,OAAO,CAAEA,CAAA,GAAMpB,QAAQ,CAAC,cAAcuB,IAAI,CAACT,MAAM,EAAE,CAAE,CAAAK,QAAA,CAAC,MAAI,CAAQ,CAAC,GALpEI,IAAI,CAACT,MAMV,CACL,CAAC,CACA,CAAC,EACF,CAAC,CAEV,CAAC,CAED,cAAe,CAAAf,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}